<% layout("/layouts/boilerplate") %>

<div class="container mt-5 mb-5">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <!-- Card Container -->
      <div class="card shadow-sm">
        <div class="card-header bg-primary text-white">
          <h4 class="mb-0">
            <i class="fa-solid fa-plus"></i> Add New Car
          </h4>
        </div>

        <div class="card-body">
          <form method="POST" action="/listings" class="needs-validation" novalidate enctype="multipart/form-data">
            
            <!-- Title -->
            <div class="mb-3">
              <label for="title" class="form-label fw-bold">
                Title <span class="text-danger">*</span>
              </label>
              <input 
                id="title" 
                name="listing[title]" 
                class="form-control" 
                type="text" 
                placeholder="e.g., Tesla Model 3"
                required
                minlength="3"
                maxlength="100"
              >
              <div class="invalid-feedback">
                Please enter a title (3-100 characters).
              </div>
            </div>

            <!-- Description -->
            <div class="mb-3">
              <label for="description" class="form-label fw-bold">
                Description <span class="text-danger">*</span>
              </label>
              <textarea 
                id="description" 
                name="listing[description]" 
                class="form-control" 
                rows="4"
                placeholder="Describe the car's features, condition, etc."
                required
                minlength="10"
              ></textarea>
              <div class="invalid-feedback">
                Please provide a description (at least 10 characters).
              </div>
              <div class="form-text">
                <span id="charCount">0</span> characters
              </div>
            </div>

           
            <!-- Image Upload -->

            <div class="mb-3">
              <label for="image" class="form-label fw-bold">
                Upload Image
              </label>
              <input 
                id="image" 
                name="listing[image]" 
                class="form-control" 
                type="file" 
                
                required
              >
              <div class="form-text">
                Optional - Leave for default image
              </div>
              <!-- Image Preview -->
              <div class="mt-3" id="previewContainer" style="display: none;">
                <label class="form-label fw-bold small text-muted">Preview:</label>
                <img 
                  id="imagePreview" 
                  src="" 
                  alt="Preview" 
                  class="img-thumbnail d-block" 
                  style="max-height: 200px; max-width: 100%;"
                  
                >
                <span 
                  id="imageError" 
                  class="badge bg-danger mt-2" 
                  style="display: none;"
                >
                  Invalid Image URL
                </span>
              </div>
            </div>


            <!-- Price -->
            <div class="mb-3">
              <label for="price" class="form-label fw-bold">
                Price (€) <span class="text-danger">*</span>
              </label>
              <div class="input-group">
                <span class="input-group-text">€</span>
                <input 
                  id="price" 
                  name="listing[price]" 
                  class="form-control" 
                  type="number" 
                  placeholder="45000"
                  min="0"
                  step="1"
                  required
                >
              </div>
              <div class="invalid-feedback">
                Please enter a valid price (minimum €0).
              </div>
              <div class="form-text" id="priceFormatted"></div>
            </div>

            <!-- Location & Country -->
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="location" class="form-label fw-bold">
                  Location <span class="text-danger">*</span>
                </label>
                <input 
                  id="location" 
                  name="listing[location]" 
                  class="form-control" 
                  type="text" 
                  placeholder="e.g., Dublin"
                  required
                >
                <div class="invalid-feedback">
                  Please enter a location.
                </div>
              </div>

              <div class="col-md-6 mb-3">
                <label for="country" class="form-label fw-bold">
                  Country <span class="text-danger">*</span>
                </label>
                <input 
                  id="country" 
                  name="listing[country]" 
                  class="form-control" 
                  type="text" 
                  placeholder="e.g., Ireland"
                  required
                >
                <div class="invalid-feedback">
                  Please enter a country.
                </div>
              </div>
            </div>

            <!-- Submit Button -->
            <button type="submit" class="btn btn-primary w-100">
              <i class="fa-solid fa-plus"></i> Add Car
            </button>

          </form>
        </div>
      </div>
    </div>
  </div>
</div>

